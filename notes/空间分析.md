空间分析
=========


--------------------------------------------------------------------------------

## 课程简介

1. 为什么要学习空间分析?
    1. 是一门广泛存在于各个行业、领域的科学
    * 有助于对事物发展规律的透彻把握
    * 提升 GIS 理论性的一个十分重要的突破口。

2. 前置课程
    * 地理信息系统
    * 程序设计
    * 地图学、空间数据库等

3. 学习内容
    * 空间分析理论 : 介绍空间分析的一些理论问题,如空间关系理论、空间认知理论、空间推理理论,以及其它理论。
    * 空间分析方法 : 介绍空间分析的各种具体方法,如栅格数据的空间分析方法、矢量数据的空间分析方法、三维数据的空间分析方法、空间数据统计分析方法等。
    * 空间分析建模 : 介绍空间分析的过程建模、应用建模。

4. 课程安排
    * ![][sa-sbus]

5. 课程要求
    * 课程内容:理解为主、重视课后作业和实践
    * 课堂作业:充分重视、认真对待
    * 课堂纪律:珍惜机会、尊重你我他

6. 考核形式
    * 平时成绩( 30% ):考勤 \ 作业 \ 实习
    * 期末考试( 70% ):闭卷考试

7. 参考资料
    * [美国国家地理信息与分析中心(美国加利福尼亚州立大学圣芭芭拉分校), Michael F. Goodchild][Ref-Ucsb]
    * [School Of Geographical Sciences & Urban Planning, Arizona State University, Luc Anselin][Ref-Asu]
    * [Department Of Geography, University Of Cambridge, 英国剑桥大学地理系][Ref-Geog-Cam]
    * [School Of Economic, Political And Policy Sciences, The University Of Texas At Dallas][Ref-Utdallas]

8. 答疑地点及方式
    * 办公室 5-401
    * Email:
    * QQ 群

[sa-sbus]: src/sa/sa-sbus.png
[ref-ucsb]: http://www.ncgia.ucsb.edu/
[ref-asu]: http://geoplan.asu.edu/
[ref-geog-cam]: http://www.geog.cam.ac.uk/people/haining/
[ref-utdallas]: http://www.utdallas.edu/~dag054000/




--------------------------------------------------------------------------------

### 第一章 绪论

###### 重点内容: 空间分析概念、空间目标、空间分析的研究内容



1. 空间分析的概念
    * What Is It?
        * 是基于地理对象的位置和形态特征的空间数据分析技术,其目的在于提取和传输空间信息( 郭仁忠 , 1997) 。
        * 是对数据的空间信息、属性信息或者二者共同信息的统计描述或说明 (Goodchild, 1987) 。
        * 是基于地理对象布局的地理数据分析技术 (Hainning, 1990) 。
        * 是对于地理空间现象的定量研究,其常规能力是操纵空间数据使之成为不同的形式,并且提取其潜在的信息 (Baily, 1995; Openshaw, 1997) 。
        * 是从一个或多个空间数据图层获取信息的过程。空间分析是集空间数据分析和空间模拟于一体的技术,通过地理计算和空间表达挖掘潜在空间信息,以解决实际问题 ( 刘湘南等
    * 关于空间分析的称谓很多,如:
        * 地理信息分析
        * 地理空间分析
        * 地理信息统计分析
        * 地理分析
        * 空间数据分析
        * 空间统计学
        * 空间统计与建模
        * 地统计学
    * 什么是空间分析研究的对象?
        * **空间目标**: 具有空间位置、分布、形态、空间关系 ( 距离、方位、拓扑、相关场 ) 等基本特征
        * 不同类型的空间目标具有不同的形态结构描述,对形态结构的分析称为**形态分析**。
        * 空间分析研究的目标?
            * 建立有效的空间数据模型来表达地理实体的时空特性,发展面向应用的时空分析模拟方法,以数字方式动态地、全局地描述地理实体和地理现象的空间分布关系,从而反映地理实体的内 在规律和变化趋势, GIS 空间分析是对 GIS 空间数据的一种增值操作。



2. 空间分析的研究内容
    * 空间分析的内容可以分为三类:
        * 基于图形的分析:包括空间数据的量算或几何操作,如 长度、面积、形状的量测,空间中心/重心的计算,叠加分析、缓冲区分析等;
        * 空间数据统计分析:如空间点模式分析、空间格 ( Lattice )数据分析和地统计学;
        * 空间模型与建模:如空间回归模型、地理加权回归、 地理模拟与计算模型(如元胞自动机、多智能体、神经网络)等。
    * 空间分析的研究内容是 GIS 领域理论性、技术性和应用性都很强的分支:
        * 空间分析的**理论**研究: 空间关系理论、空间认知理论、空间推理理论、空间数据的不确定性分析理论等
        * 空间分析的**方法**研究: 矢量数据的空间分析方法、栅格数据的空间分析方法、三维数据的空间分析方法、属性数据的空间统计方法
        * 空间分析**建模与应用**研究: 研究空间分析的建模过程与方法。其广泛适用于卫生健康领域、水利领域、城市管理、地质灾害、地震灾害、交通领域、电力领域、环保领域、气候变化领域等。

3. 空间分析的研究进展
    * 典型例子:基于空间分析的霍乱病患者发病原因分析
    * 空间分析的研究脉络
        * 20 世纪 60 年代: 主要集中在对空间数据的分析和空间自相关的测度上
        * 1970s~1980s :空间统计学高速发展时期
        * 1990s 以后:空间分析的发展和 GIS 的发展密切结合在一起。
    * 空间分析关键技术的变化
        * 地理信息系统和遥感等新技术保证了空间数据的丰富环境,新的处理空间问题的分析模型和方法不断提出。
        * 探索性空间分析技术、可视化技术、空间数据挖掘技术、基于人工智能的空间分析技术等面向海量的空间数据分析方法受到重视,在最近几年得到深入发展。
        * 大规模空间分析问题中的不精确性和不确定性
        * 大数据问题对空间分析造成的影响
        * ![][sa-big-data]

4. 空间分析与 GIS
    * 空间分析是 GIS 的核心
        * ![][sa-core-of-gis]
    * 空间分析功能与 GIS 其他功能的关系
        * ![][sa-gis-other-fun-relation]
    * 是提升 GIS 作为一门独立学科重要突破口
        * GIS = Geographic Information System
        * GIS = Geographic Information Science
        * GIS = Geographic Information Service
        * GIS = Geographic Information Service + Internet = New Service / Web Service

5. 空间分析与应用模型
    * 应用模型是空间分析不可或缺的一部分
        * GIS 可以输入、存储、操作、管理空间数据,并以图形等直观形式表达输出结果,但它本身缺少强大的空间分析能力。空间模型对空间数据进行精确地模型运算,但其结果常常需要通过 GIS 来表达。 GIS 和空间分析模型在功能上的互补是 GIS 与空间模型结合的主要动力。
    * 应用模型和空间分析应该区分开来
        * 地学研究中往往涉及很复杂的分析过程,这些过程尚不能完全用数学和算法来描述 , 所以 GIS 应用模型时常采用定量和定性相结合的形式。
        * 对于专业模型来说,由于 GIS 应用领域的不同,不可 能建立通用的、包罗一切的专业模型,专业模型只能通过用户自己创建。


[sa-big-data]: src/sa/sa-big-data.png
[sa-core-of-gis]: src/sa/sa-core-of-gis.png
[sa-gis-other-fun-relation]: src/sa/sa-gis-other-fun-relation.png



--------------------------------------------------------------------------------

### 第二章 空间分析的基本理论

###### 重点内容: 拓扑关系、度量关系、顺序关系

1. 空间关系理论
    * 空间关系简介
        * 空间关系是 GIS 的重要理论问题之一,在空间数据建模、空间查询、空间分析、空间推理、制图综合、地图理解等过程中都起着重要作用。
            * 可以由空间现象的**几何特性**引起,如距离、方位、连通性、相似性等
            * 可以由空间现象的**几何特性和非几何特性共同引起**,如空间分布现象的统计相关、空间自相关、空间相互作用、空间依 赖等
            * 可以完全由空间现象的**非几何属性**导出空间关系
        * 空间关系之间的约束强度: 度量关系 > 顺序关系 > 拓扑关系
            * 拓扑空间关系是指拓扑变换下的拓扑不变量,如空间目标的相邻和连通关系, 橡皮几何学
            * 方向关系是最基本的顺序关系,又称为方位关系、延伸关系,是指源目标相对于参考目标的顺序关系。
            * 度量关系
                * 定量化描述: 利用距离公式量测两个空间目标间的度量关系。定量度量空间关系分析包括空间指标量算和距离度量两大类
                * 定性度量量测
        * 为什么要研究空间关系的描述方法?
            * 以数学或逻辑的方法区分不同的空间关系,对空间关系给出**形式化的描述**。有助于**澄清**不同用户关于空间关系的语义,为构造空间查询语言和空间分析提供形式化工具。
            * 空间分析建立在空间目标位置和属性表达以及目标间复杂空间关系表达的基础上 , 若**要提高空间分析能力** , 必须解决空间关系描述与表达。
        * 如何评价空间关系描述模型?
            * 一般从完备性、严密性、唯一性、通用性准则等方面进行评估。
            * 完备性是指空间关系描述结果能包含目标间所有可能的定性关系;
            * 严密性是要求所推出的一组关系是实际存在或正确的;
            * 唯一性要求所有关系是互斥的;
            * 通用性指描述方法应能处理各种形状的目标和各类关系。
    * 拓扑空间关系
        * 意义
            * 清楚地反映实体之间的逻辑结构关系
            * 有助于空间要素的查询,利用拓扑关系可以解决许多实际问题。
            * 根据拓扑关系可重建地理实体。
        * 常见的拓扑关系描述方法
            * 4 元组模型
                * 边界点和内部点
                * ![][sa-topo-4]
                * 2^4 = 16, But In Fact
                    * 2 种点 / 点拓扑关系
                    * 3 种点 / 线拓扑关系
                    * 3 种点 / 面拓扑关系
                    * 16 种线 / 线拓扑关系
                    * 13 种线 / 面拓扑关系
                    * 8 种面 / 面拓扑关系
            * 9 元组模型
                * 边界、内部和外部
                * ![][sa-topo-9]
                * 引入了“补”的概念,矩阵模型可区分 512 种关系,但具有实际意义的只有一小部分
                    * 2 种点点间关系、 3 种点线间关系、 3 种点面间关系、
                    * 33 种线线间关系、 19 种线面间关系、
                    * 8 种面面间关系。
            * V9I 模型
                * 用空间目标的 Voronoi 区域 (Voronoi Region) 作为其外部,对原 9 元组模型进行改进,建立了一种基于 Voronoi 的新 9 元组模型,简称为 V9I 模型。
                * ![][sa-topo-v9i]
            * 顺序空间关系
    * 度量空间关系
        * 顺序空间关系 (相对方向, 绝对方向)
        * 定性描述模型主要包括:
            * 锥形模型
            * 最小约束矩形模型 (MBR)
            * 二维字符串模型 (2-D String)
            * 方向关系矩阵模型, 3x3: 2^9 Combinations. 用源目标在某一方向片区的面积比例代替交集。
            * 基于 Voronoi 图的方向关系模型
        * 度量空间关系:空间指标量算、距离度量
            * Plane Distance
                * Euclidean
                * Manhattan
                * ChebyShev, 3x3, D(I, J) == 1, Except When I == J == 2
            * Surface Distance
                * 大地测量距离
                * Revised 曼哈顿距离:纬度差加上经度差
                * 旅游时间距离
                * 词典编纂距离
            * 曲线与曲线间的距离可以通过最小距离、平均距离、 Hausdorff 距离和 Frechét 距离等方式计算等
    * 时空空间关系: 时空拓扑关系 (Spatio-Temporal Topology)
        * ![][sa-topo-time-allen]

2. 地理空间认知
    * 地理空间认知概述
        * Geospatial Cognition
            * 地理空间认知是指在日常生活中,人类如何逐步**理解地理空间**,进行地理**分析**和**决策**,包括地理信息的知觉、编码、存储、记忆和解码等一系列心理过程。
        * 地理空间认知过程
            * 经过**地理感知**、**表象再现**、**地理记忆**和**地理思维**四个过程,借助**图像**或者**地图**(心像地图和认知制图)来实现的。
        * 1995 年美国国家地理信息与分析中心 (NCGIA) 发表了“ Advancing Geographic Information Science” 的报告,提出地理信息科学的三大战略领域:
            * 地理空间认知模型
            * 地理概念计算方法
            * 地理信息与社会研究
        * 研究内容
            * 事物在地理空间中的位置(**Where**)和地理事物本身性质(**What**)。地理空间认知是认知科学与地理科学的交叉学科。
            * 主要包括: 地理知觉、地理表象、地理概念化、地理知识的心理表征和地理空间推理,涉及地理知识的获取、存储和使用。
    * 地理知觉
        * 知觉是对感觉信息的组织和解释,即获得感觉信息意义的过程
        * 地理知觉是指将地理事物从地理空间中区分出来,获取其位置信息并对其进行识别
        * 格式塔心理学 (Gestalt Psychology), 又称为完形心理学
            * ![][sa-gestalt-a]
            * ![][sa-gestalt-b]
            * 揭示了知觉的相对性、整体性、恒常性和组织性等基本特征,并总结了称之为组织律的系列知觉组织原则,包括
                * 图形—背景原则
                * [接近原则][sa-gestalt-near]
                * 连续原则
                * [相似性原则][sa-gestalt-similar]
                * [闭合和完整倾向原则][sa-gestalt-full]
                * 共向性原则
                * 简单原则等。
            * 透镜模型
            * 供给模型
        * 对象和位置系统的分离
        * Marr 的草图模型
            * 关于地理知觉过程和步骤影响最大的理论,对知觉过程和步骤的进一步研究大都在 Marr 的基础上进行
            * Marr 认为:视觉信息处理是依靠 3 级结构“要素图 -2.5 维图 - 三维模型表象”来加以处理的。表达外部信息的基本要素是点、边缘、面等。
        * 知觉方式对地理空间尺度划分的意义
            * 知觉方式的不同是空间尺度划分的主要依据
            * 心理学根据不同尺度空间知觉方式的不同,将空间划分为:图形、街景、环境和地理空间。
        * 环境空间与地理空间的知觉方法差异
            * 环境空间的知觉主要靠导航经验;
            * 地理空间的知觉主要靠读图;
    * 地理表象
        * 地理表象用来表示在地理意向性理论指导下的地理形象思维所产生的各种“象”,它既是地理思维活动的产物, 又是地理思维得以进行的载体,与地理知识的使用和地理空间的推理密切相关。
        * 类命题理论(可用于拓扑关系的描述) 和准图片理论(可用于地理模拟)
        * 地理表象分为四类:
            * 地理区域
            * 综合体
            * 地理景观
            * 区域地理系统
    * 地理概念化
        * 概念化方法:
            * 经典集合论 (广泛用于 GIS 语义表达和共享,其特点包括:分类是任意的;类型具有定义属性或关键属性;集合的内涵决定其外延。)
            * 原型分类(原始分类)
                * 更符合日常人的认知分类
                * 特点包括:
                    * 分类不是任意的;
                    * 基础层次类型各个成员享有更多相似的知觉和功能特征;
                    * 类型具有一种内在的渐变结构,基于核心成员 - 原型而构建, 类型不具有关键属性,事物类型的归属通过其与原型的相似 程度来判定;
                    * 在原型分类下,类型集合的边界是模糊的,为模糊集
        * 概念化理论
            * 地理概念存储方式理论(图式理论)
            * 概念形成因素理论(初级理论,次级理论)
        * 地理本体
            * 本体是对世界本质的研究。
            * 地理实体本体主要处理地理实体类型的本质和内涵。地理信息科学中的本体兼具哲学本体和信息本体的双重含义。
            * 地理本体是面向地理领域的概念模型,它包含领域内通用的、普遍的概念,并且规定了领域级别上的约束,这些约束可以被用来进行知识级别上的推理。
            * 地理本体表达的是更高级别的信息需求
            * 地理本体的研究可以为以下几个主要方面提供重要的理论与方法支撑 :
                * 语义互联网
                * 地理信息系统之间的语义互操作
                * 知识级地理信息共享与知识重用
                * 地球科学中语义建模
    * 地理知识心理表征
        * 地理知识编码: Kosslyn 认为记忆中心理表征与视觉表征类似,所以地理知识的心理编码方法主要包括:表象理论、概念命题理论和双重编码理论。
            * **表象理论**的核心内容是图片的隐喻,环境的视觉信息经过大脑加工,以图解的形式进行简化和有序编码与存储,并存在一定的扭曲
            * **概念命题理论**认为所有视觉信息和语言信息都以概念命题的形式进行存储,其强调视觉信息被输入后,必须处理为概念命题的形式才能进行存储。
            * **双重编码理论**认为表象和命题形式的编码共存,其相互分离,并行运转,同时又互相联系。

3. 地理空间推理
    * 地理空间推理概述
        * 空间推理是指利用空间理论和人工智能技术对空间对象进行建模、描述和表示,并据此对空间对象间的空间关系进行定性或定量分析和处理。
        * 地理空间推理主要研究地理事物在地理空间中位置的表达和相关推理。
    * 地理空间推理特点
        * 以空间和存在于空间中的空间对象为研究对象。
        * 推理过程中运用人工智能技术和方法。
        * 处理的是一个或几个推理的问题。
        * 基于空间和存在于空间中的空间对象已经被建模的前提下,不能在没有模型的情况下讨论空间推理。
        * 必须能够给出关于空间和存在于空间中的空间对象的定性或定量的推理结果。
        * 必须能够描述空间行为。
        * 空间推理模型把问题分解为几个组成部分时,必须能够描述这些组成部分的相互作用。
        * 空间推理过程中,可能用到空间谓词,空间中确定的点使某些空间谓词为真,而使另一些空间谓词为假。
        * 应该能够处理带有模糊性和不确定性的空间信息。
        * 应该能够添加和处理时间因素,即成为时空推理。
        * 应该具有空间自然语言理解能力。
    * 地理空间推理研究内容
        * 根据空间目标的位置,基于给定的空间关系形式化表示模型,推断空间目标之间的**空间关系**。
        * 根据空间目标之间的已知基本空间关系,推断空间目标之间未知的空间关系。
        * 利用空间推理,从空间数据库中挖掘空间知识,也可以利用事件推理的方法进行空间目标的模糊查询。
        * 基于常识的空间推理研究**时空推理**
        * 定性空间推理

4. 空间数据的不确定性分析
    * 不确定性简述
        * 不确定性是指被测量对象知识缺乏的程度,通常表现为随机性和模糊性。
            * 随机性的特点是可重复观察,在观察之前知道所有可能的结果,**但不知道到底哪一种结果会出现**。
            * “一粒”和“一堆”是有区别的两个概念,它们的区别是渐变的,不是突变的,两者之间并**不存在明确的界限,这种不确定性就是模糊性**。
    * 空间数据的不确定性
        * 在地理数据**采集**和**处理**过程中的地理数据不确定性问题
        * **位置、边界、属性**不确定性问题。
        * **逻辑不一致性**和**数据不完整性**。
        * 空间分析中不确定性的传播规律以及可视化表达方法。
        * 在决策过程中的地理数据不确定性 ,
        * 建立基于不确定性地理数据处理的空间决策支持系统。
        * 与地理数据不确定性有关的标准规范
    * 空间分析方法的不确定性
        * 网络分析的不确定性
        * 统计分析及其不确定性
        * 叠置分析的不确定性
        * 缓冲区分析的不确定性
        * 不确定性的可视化也是 GIS 空间分析的主要研究领域之一。
            * 空间数据质量的可视化采用直观的二维、三维图形或其它灵活的形式表现出数据的质量,可以把抽象的数据质量度量表现出来。
            * 空间矢量数据误差模型的可视化表示
            * 栅格数据 ( 如影像分类 ) 结果不确定性的可视化表示、
            * GIS 分析应用结果中不确定性的可视化等。
    * 不确定性分析的数学基础
        * **概率理论**
            * 主要用于处理由于随机误差而产生的不确定性。在概率论中,不确定性被描述成在给定某些观测值的条件下某一假设成真的条件概率。
        * **证据理论**
            * 证据理论是对传统概率论的一个扩展。
            * 具有处理不确定信息的能力。
            * 作为一种不确定推理方法,证据理论的主要特点是:满足比贝叶斯概率论更弱的条件;具有直接表达“不确定”和“不知道”的能力。
        * **模糊集和粗糙集理论**
        * **云模型**
            * 云由系列云滴组成,具有期望值 Ex 、熵 En 和超熵 He 3 个数字特征。
            * **期望**反映了云滴在论域空间分布的期望;
            * **熵**是定性概念不确定性的度量, 其值越大,概念的不确定性越大;
            * **超熵**反映云滴的离散程度,其值越大,云滴的离散度越大。
            * ![][sa-cloud-model]
        * **分形理论**
            * 在任意小的尺度下,都有复杂的细节,具有精细结构。
            * 自相似性,自相似可以是近似的或者统计意义的。
            * 不规则性,整体和局部都难以使用传统的几何语言描述。
            * 分形的维数大于拓扑的维数。
            * 大多数情况下,分形可以非常简单的方式生成,如迭代。


[sa-topo-4]: src/sa/sa-topo-4.png
[sa-topo-9]: src/sa/sa-topo-9.png
[sa-topo-v9i]: src/sa/sa-topo-v9i.png
[sa-topo-time-allen]: src/sa/sa-topo-time-allen.png
[sa-gestalt-a]: src/sa/sa-gestalt-a.png
[sa-gestalt-b]: src/sa/sa-gestalt-b.png
[sa-gestalt-full]: src/sa/sa-gestalt-full.png
[sa-gestalt-similar]: src/sa/sa-gestalt-similar.png
[sa-gestalt-near]: src/sa/sa-gestalt-near.png
[sa-cloud-model]: src/sa/sa-cloud-model.png




--------------------------------------------------------------------------------

### 第三章 栅格数据空间分析

1. 栅格空间数据
    * 地理空间认知模型主要有三个:
        * 场模型:强调空间要素的连续性
        * 基于对象的模型:强调空间要素的离散性
        * 网络模型:强调空间要素的交互
    * 在空间信息系统中,场模型一般指的是栅格模型, 其主要特点就是用二维划分覆盖整个连续空间。划分可以是规则的或不规则的
    * 栅格数据由一系列的规则格网单元组成,用于表达专题、光谱及图像等数据,可以在一定空间范围内模拟连续变化的地理现象或图片数据。
    * 一个栅格数据集(就象一幅地图),描述了某区域的位置和特征。单个栅格数据集只能代表单一专题
    * 栅格数据的组织方式
        * 分类区( Zones )
        * 坐标空间
        * 点要素
        * 线要素
        * 多边形要素(面要素)

2. 栅格数据的聚类、聚合分析
    * 将栅格数据系统经某种变换而得到具有新含义的栅格数据系统的数据处理过程。
    * 聚类分析是根据设定的条件对原有数据系统进行有选择的信息提取而建立新的栅格数据系统的方法。
        * 单层面聚类分析
        * 多层面聚类分析
    * 聚合分析是指根据空间分辨率和分类表 ,进行数据类型的合并或转换以实现空间地域的兼并。

3. 栅格数据的信息复合分析
    * 信息复合模型 (Overlay) 包括两类: 简单的视觉信息复合和较为复杂的叠加分类模型。
    * 视觉信息复合
        * 面状图、线状图和点状图之间的复合;
        * 面状图区域边界之间或一个面状图与其它专题区域边界之间的复合;
        * 遥感影像与专题地图的复合;
        * 专题地图与数字高程模型复合显示立体专题图;
        * 遥感影像与 DEM 复合生成真实三维地物景观。
    * 较为复杂的叠加分类模型: 数学运算复合 = 算术运算 + 函数运算

4. 栅格数据的追踪分析

5. 栅格数据的窗口分析
    * 窗口分析 = [ 中心点 + 分析窗口大小与类型(矩 圆 环 扇) + 运算方式(统计运算,测度运算,函数运算) ]

6. 栅格数据的量算分析




--------------------------------------------------------------------------------

### 第四章 矢量数据空间分析

1. 矢量数据模型
    * 矢量数据对有确定位置与形状的离散要素是**理想**的表示方法。
    * 矢量数据空间分析:
        * 一般不存在模式化的分析处理方法
        * 表现为处理方法的多样性和复杂性
    * 矢量数据空间分析的基础 —— 矢量数据模型
        * 矢量数据模型是把 GIS 数据组织成点、线、面几何对象的形式,是基于对象实体模型的计算机实现。
        * 构建矢量数据模型步骤:
            * 简单的几何对象(点、线和面)来表示空间要素
                * 基本单元是**点及点的坐标**
                * 线由点构成 = 两个端点 + 端点之间标记线
                * 面通过线定义,通过边界把面要素区域分为内部区域和外部区域。单独/相连的面要素
                * 面要素可相互重叠产生重叠区域
                * 面要素可在其他面要素内形成岛。
            * 明确地表达空间要素之间的相互关系(空间关系)
                * 拓扑关系用来表达空间要素之间的空间关系。
            * 建立恰当的数据文件逻辑结构
                * 拓扑数据结构带拓扑关系的矢量数据模型在计算机中表现为数据文件结构和文件之间的关系。
            * 陆地表面数据、重叠的空间要素和路网适用于简单几何对象的组合来表示
                * 不规则三角网
                * 区域数据模型
                * 线性参考和动态分段

2. 矢量数据的包含分析
    * 包含分析是一些空间分析功能的重要组成部分
    * 用于确定空间要素(点、线、面)之间在空间位置上的联系。
        * 点和点,点和线,点和面
        * 线和线 (一条线完全或部分包含另一条线),线和面 (线完全落在面内)
        * 面和面 (面完全被另一个面包含)
    * 点在多边形内的判别方法
        * 用过点的垂直线与多边形交点分布的奇偶性
        * 角度计算
        * ![][sa-point-overlay]

3. 矢量数据的缓冲区分析
    * 基于近邻的概念把空间分为两个区域: 位于所选空间要素 (点、线、面) 的指定距离之内 ( 缓冲区 )/ 外
    * 缓冲区分析是基于空间目标拓扑关系的距离分析。(数学观点的分析, In A Math Way)
    * 基本思想:给定一个空间目标,确定它们的某邻域,邻域的大小由邻域半径决定。
    * 空间目标 Oi 的缓冲区定义为: Bi = { X : D(X, Oi) <= R }
    * 空间目标集合的半径为 R 的缓冲区是单个物体的缓冲区的并: A.K.A. B = Sigma(Bi) For I In 1..N
    * 点,线,面目标的缓冲; 复杂目标的缓冲
    * 缓冲区分析包括两个部分:
        * 缓冲区域的生成
        * 在缓冲区域内进行的各种统计分析或查询分析
    * 缓冲区分析算法的关键:
        * 缓冲区的生成
        * 多个缓冲区的合并
    * 点
        * 直接绘圆法,圆弧步进拟合法
        * ![][sa-gen-buffer]
        * 特殊情况下点状目标缓冲区
            * 对点状目标,还可以生成三角形、矩形、圆形等特殊形态的点缓冲区;
            * 对于相邻多个点目标的缓冲区分析,根据需要合并,消除重叠区域。可以融合也可以保留。
    *  线
        * 以线状目标为参考轴线,以轴线为中心向两侧沿法线方向平移一定距离,并在线端点处以光滑曲线连接,所得到的点组成的封闭区域。
        * 实质:对线状目标上的坐标点逐点求得其缓冲点的过程。
        * 线缓冲区生成关键算法:
        * 缓冲区边界点的生成,多个缓冲区的合并
        * 角平分线法
            * ![][sa-gen-buffer-line]
            * 角平分线的缺点: 难以保证双线的等宽性,轴线转角尖锐的转折点将随缓冲距的增大迅速远离轴线
        * 凸角圆弧法
        * 基本思想: 在轴线的两端用半径为缓冲距的圆弧拟合; 在轴线转折点,判断该点的凹凸性,在凸侧用半径为缓冲距的圆弧拟合,在凹侧用与该点关联的两缓冲线的交点为对应缓冲点。
            * 优点: 凸侧的缓冲线与轴线等宽,而凹侧的对应缓冲点位于凹角的角平分线上,因而最大限度地保证缓冲区边界与轴线的等宽关系。
            * ![][sa-gen-buffer-line2]
        * 特殊情况的缓冲区:
            * 指定不同线状目标的不同的缓冲区宽度;
            * 同一线状目标两侧的缓冲区宽度也可以不一样;
            * 同一线状目标不同段的缓冲区宽度也可以不一样;
    * 面
        * 面目标缓冲区:内侧缓冲区和外侧缓冲区
        * 缓冲线生成过程中的特殊情况:
            * 缓冲线失真(Unavoidable)
                * ![][sa-distortion-a]
                * ![][sa-distortion-b]
            * 缓冲线自相交
                * 当轴线的弯曲空间不能容许缓冲区边界自身无压覆地通过时,缓冲线将产生自相交现象,并形成多个自相交多边形:
                    * 岛屿多边形——保留
                    * 重叠多边形——删除
                    * 识别是岛屿多边形还是重叠多边形是缓冲线自相交处理的关键。
            * 缓冲区重叠等
    * 静态缓冲区: 空间目标对邻近对象的影响呈现单一的距离关系
    * 动态缓冲区: 空间目标对邻近对象的影响呈现不同强度的扩散或衰减关系。动态缓冲区生成的关键是**如何确定缓冲距**
    * 动态缓冲区生成算法:
        * 基于线目标的缓冲区生成算法: 用分段处理的办法分别生成各流域分段的缓冲区,然后按某种规则将各分段缓冲区光滑连接
        * 基于点目标的缓冲区生成算法: 用逐点处理的办法分别生成沿线各点的缓冲圆,然后求出缓冲圆序列的两两外切线,所有外切线相连。
    * 动态缓冲区的常见分析模型

4. 矢量数据的叠置分析
    * 大部分 GIS 软件是以**分层**的方式组织地理景观, 将地理景观**按主题分层存取**。
    * 在**统一的空间坐标系下**,将**同一地区**的两个或两个以上的**地理要素图层进行叠置**,产生空间区域的**多种属性特征**的分析方法。

    * 点与点的叠置
        * 含义: 把一个图层上的点与另一个图层上的点进行叠置, 为图层内的点建立新的属性,同时对点的属性进行统计分析。
        * 实现: 通过不同图层间的点的位置和属性关系完成,得到一张新属性表,属性表示点之间的关系。
    * 点与线的叠置
        * 含义: 一个图层上的点目标与另一图层上的线目标进行叠置,为图层内的点和线建立新的属性。
        * 应用: 叠置分析的结果可用于点和线的关系分析,如计算点与线的最近距离。
    * 点与多边形的叠置
        * 含义: 实际上是计算多边形对点的包含关系。将一个含有点的图层叠加到另一个含有多边形的图层上,以确定每个点落在哪个多边形内。
        * 实现: 通过点在多边形内的判别完成,通常得到一张新属性表,包含:
            * 原属性
            * 落在那个多边形的目标标识
            * 还可以从多边形属性表中提取一些附加属性
        * 应用
    * 线与线的叠置
        * 含义: 一个图层上的线与另一图层的线叠置,分析线之间的关系,为图层中的线建立新的属性关系。
        * 应用: 如河流与公路的叠置分析结果,可以分析水陆交通运输的分布情况。
    * 线与多边形的叠置
        * 含义: 将线的图层叠置在多边形的图层上,以确定一条线落在哪一个多边形内。
        * 实现: 比较线上坐标与多边形坐标的关系,判断线是否落在多边形内。
        * 应用: 公路线图层与县城图层进行叠加分析
    * 多边形与多边形的叠置
        * 含义:指同一地区、同一比例尺的两组或两组以上的多边形要素进行叠置。
            * 被叠置的多边形为本底多边形;
            * 用来叠置的多边形为上覆多边形;
            * 叠置后产生具有多重属性的新多边形。
        * 实现:
            * 将两层多边形的边界全部进行边界求交运算和切割;
            * 然后根据切割的弧段重建拓扑关系;
            * 最后判断新叠置的多边形分别落在原始多边形层的哪个多边形内,建立叠置多边形与原多边形的关系,如果必要再抽取属性。
            * 根据两组多边形边界的交点来建立具有多重属性的多边形——地图内容的合成叠置。
            * 进行多边形范围内的属性特性的统计分析——地图内容的统计叠置。
    * 基本方法
        * 图层擦除( Erase )
            * ![][sa-overlay-erase]
        * 识别叠加( Identity )
            * 指输入图层和另外一个图层进行识别叠加,在图形交迭的区域,识别图层的属性将赋给输入图层在该区域内的地图要素,同时也有部分的图形的变化在其中
            * ![][sa-overlay-identity]
        * 交集操作( Intersect )
            * 得到两个图层的交集部分,并且原图层的所有属性将同时在得到的新的图层上显示出来
            * ![][sa-overlay-intersect]
        * 交集取反( Symmetrical Difference )
            * ![][sa-overlay-sym-diff]
        * 图层合并( Union )
        * 修正更新( Update )

5. 矢量数据的网络分析
    * 网络分析是通过模拟、分析**网络状态**以及资源在网络上的**流动**和**分配**等,研究网络结构、流动效率及网络资源等的优化问题。
    * 网络分析是对**地理网络**和**城市基础设施网络等网状事物**以及它们的**相互关系和内在联系**进行地理分析。
    * GIS 中的网络
        * 具有图论中网络的边、节点、拓扑等特征。
        * 还具有空间定位上的地理意义、目标复合上的层次意义和地理属性意义。如交通网络中除道路网络外,还涉及车站、路况、通行能力等
    * GIS 中网络的组成
        * 线状要素 —— 链、弧段 (有形的:街道; 无形的:无线通讯网络)
        * 点状要素 ——结点(障碍点、拐角点)、中心、站点
            * 几何属性
            * 拓扑关系(结点—弧段拓扑关系)
            * 特殊属性 (阻抗强度、资源容量、资源需求
    * 网络流量: 网络上从起点到终点的某个函数, 如运输价格、运输时间等。
    * 网络分析的主要目的: 选择最佳路径 + 选择最佳布局中心位置
    * 网络分析的常见问题:
        * 地址匹配: 对地理位置的查询,涉及到地址的编码。地址匹配与其它网络分析功能结合起来,可以满足实际工作中非常复杂的分析要求。
        * 路径分析: 最短路径+静态最佳路径+N 条最佳路径+动态最佳路径
            * 网络: 网络的每一条弧段都有一个权值,表示弧段连接的两结点间阻抗值。
            * 权值: 正值 Or 负值, But GIS 中的一般最短路径问题都不涉及负回路的情况,因此以下所有的讨论中假定弧的权都为非负值。
        * 资源分配: 资源分配模型由中心点 ( 分配中心 ) 及其状态属性和网络组成。分配方式包括:
            * 由分配中心向四周输出
            * 由四周向中心集中
        * 最佳选址: 选址功能是指在一定约束条件下、在某一指定**区域内选择设施的最佳位置**,它**本质上是资源分配分析的延伸**。
    * 最短路径
        * 路径分析是网络分析的核心问题,是对最佳路径的求解,即在指定网络的两个节点之间找一条阻抗强度最小的路径。
        * **最短路径算法是路径分析问题的基础**,其表述如下: 若<Vi,Vj>的权wij表示节点vi和vj间的长度,在vi和vj之间的所有路径中,寻求长度最小的路径,称为从vi到vj的最短路径。
        * 数学表达: D(X,Y) ≤ D(X,Z) + D(Z,Y)
        * 最短路径问题的求解:
            * BFS, DFS
            * 边无负权值: Dijkstra 算法 / A Star 算法
            * 可以处理负权: Bellman-Ford 算法 / Floyd-Warshall 算法 / SPFA 算法
        * Dijkstra 算法
        * A Star 算法
        * Bellman-Ford
            * 初始化所有点
            * 进行循环
            * 遍历途中所有的边 Edge(U , V)

6. ArcGIS 的矢量数据空间分析工具
    * 缓冲区分析
        * 普通缓冲区
        * 属性权值缓冲区
        * 分级缓冲区
    * 叠置分析
        * 图层擦除
        * 识别叠加
        * 交集操作
        * 对称区别
        * 图层合并
        * 修正更新
    * 网络分析
        * 传输网络分析 (Network Analyst)
            * 计算点与点之间的最佳距离
            * 进行多点的物流派送
            * 寻找最近的一个或者多个设施点
            * 确定一个或者多个设施点的服务区
            * 绘制“起点 - 终点”的距离矩阵
        * 效用网络分析 (Utility Network Analyst)
            * 效用网络是有向网络,网络中流动的对象必须按照在网络中定义好的规则前进,运行路径是事先定义好的
            * 在 ArcGIS 中,效用网络是通过几何网络来模拟的。
            * 效用网络常用于水、电、气等管网的连通性分析:
                * 寻找连通的或不连通的管线;
                * 进行上游或下游追踪;
                * 寻找环路;
                * 寻找通路或进行爆管分析等。


[sa-point-overlay]: src/sa/sa-point-overlay.png
[sa-gen-buffer]: src/sa/sa-gen-buffer.png
[sa-gen-buffer-line]: src/sa/sa-gen-buffer-line.png
[sa-gen-buffer-line2]: src/sa/sa-gen-buffer-line2.png
[sa-distortion-a]: src/sa/sa-distortion-a.png
[sa-distortion-b]: src/sa/sa-distortion-b.png
[sa-overlay-erase]: src/sa/sa-overlay-erase.png
[sa-overlay-identity]: src/sa/sa-overlay-identity.png
[sa-overlay-intersect]: src/sa/sa-overlay-intersect.png
[sa-overlay-sym-diff]: src/sa/sa-overlay-sym-diff.png




--------------------------------------------------------------------------------



#### 第五章 三维数据空间分析
##### DEM 、 TIN 、面积体积量算方法、坡度坡向计算方法、缓冲区分析、水文分析、可视性分析


1. 三维地形模型
    * 高度变化有可能引起:
        * 气候变化
        * 土壤、植被、地质变化
        * 地物变化
        * 其它
    * 数字地面模型 Digital Terrain Model, DTM
        * DTM 是指描述地球表面形态多种信息空间分布的有序数值阵列
        * 从数学的角度,可用如下二维函数系列取值的有序集合表示数字地面模型 :
            * Kp=fk(up,vp) (k=1..m; p=1..n)
            * Kp: 第 p 号地面点 ( 单一点或某点及其微小邻域所划定的一个地表面元 ) 上的第 K 类地面特性信息的值;
            * (up, vp): 第 p 号地面点的二维坐标 ;
            * m(m 大于等于 1): 地面特性信息类型的数目;
            * n: 地面点的个数。
            * ![][sa-digital-terrian-model]
    * 数字高程模型
        * DEM 是 DTM 的一个特例或者子集, 是 DTM 中最基本的部分,是对地球表面地形地貌的一种离散的数学表达。
        * DEM 的具体应用
            * 国家地理信息的基础数据: DEM 是国家空间数据基础设施 NSDI 的框架数据组成部分,是“ 4D 产品”之一。
            * 土木工程、景观建筑与矿山工程的规划与设计;
            * 军事目的 ( 军事模拟等 ) 的地表三维显示;
            * 景观设计与城市规划;
            * 水流路径分析、可视性分析;
            * 交通路线的规划与大坝的选址;
            * 不同地表的统计分析与比较;
            * 生成坡度图、坡向图、剖面图,辅助地貌分析,估计侵蚀和径流等;
            * 作为背景数据叠加各种专题信息,如土壤、土地利用及植被覆盖数据等,便于显示与分析。
        * ![][sa-dem-present]
        * DEM 的表示方法
            * 数学方法
                * 整体拟合: 将区域中所有高程点的数据用傅里叶高次多项式、随机布朗运动函数等统一拟合高程曲面。
                * 局部拟合: 把地面分成若干块,每一块用一种数学函数,如傅立叶级数高次多项式、随机布朗运动函数等,以连续的三维函数高平滑度地表示复杂曲面。
            * 图形法
                * 线模式: 利用离散的地形特征模型表示地形起伏。如:等高线、山脊线
                * 点模式: 用离散采样数据点建立 DEM ,是最常用的生成 DEM 的方法之一
                    * 点数据的采样方式:规则格网模式 (Grid)(正方形、矩形、三角形格网)、不规则模式 (TIN) 、根据山峰、洼坑等地形特征点有针对性地采样
                    * 规则格网模型
                        * 格网栅格的观点——格网单元的数值是其中所有点的高程值,即格网单元对应的地面面积内高程是均一的高度,这种数字高程模型是一个不连续的函数。
                        * 点栅格观点——该网格单元的数值是网格中心点的高程或该网格单元的平均高程值,这样需要用一种插值方法来计算每个点的高程。
                        * 优点:
                            * 结构简单、易于计算机处理,特别是栅格数据结构的地理信息系统
                            * 可以很容易地计算等高线、坡度、坡向、山坡阴影和自动提取流域地形
                        * 缺点:
                            * 地形简单的地区存在大量冗余数据
                            * 地形起伏差别大的地区无法适用
                            * 对某些特殊计算 ( 如视线计算 ) 的格网轴线方向被夸大
                            * 如栅格过于粗略,则不能精确表示地形的关键特征,如山峰、坑洼、山脊、山谷等
                    * 不规则三角网( TIN )
                        * 优点:
                            * 可根据地形的复杂程度确定采样点的密度和位置,能充分表示地形特征点和线,减少了地形较平坦地区的数据冗余。
                            * 在显示速度及表示精度方面优于规则格网
                            * TIN 是一种变精度表示方法:平坦地区数据点较少,地形起伏较大的地区数据点密度较大。这种机制使得 TIN 数据可用较小的数据量实现较高的表达精度。
                    * TIN 方法的特点 ( 与 Grid 相比 ) :
                        * 从等高线数据中选取重要的点构成 TIN ,并生成规则格网,在两者数据量相同的情况下, TIN 数据具有最小的中误差 RMS
                        * 与数字正射影像 (DOM) 的叠加方面,基于 TIN 的地形图与影像的吻合程度比规则格网的地形图好;
                        * 当采样数据点的数量减少时,规则格网模型的质量比 TIN 模型降低的速度快,但随着采样点或数据密度的增加,两者的差别会越来越小。
                        * 从数据结构占用的数据量来看,在顶点个数相同的情况下, TIN 的数据量要比规则格网的大 ( 约 3~10 倍 ) 。
    * ![][sa-grid-tin-contour]
    * DEM 在地图制图学与地学分析中的应用
        * 绘制晕渲图
            * 晕渲图:采用光线照射使地表产生反射的地面表示方法,用于表现地貌地势。
            * 用 DEM 数据为信息源,以地面光照通量为依据,计算栅格输出的灰度值,由此得到晕渲图的立体效果,逼真程度很好。
            * 生成地面晕渲图的计算方法:
                * 首先根据 DEM 数据计算坡度和坡向;
                * 将坡向数据与光源方向比较:
                * 面向光源的斜坡得到浅色调灰度值;
                * 反方向得到深色调灰度值;
                * 两者之间得到中间灰值,中间灰值由坡度进一步确定。
        * 绘制透视立体图
            * 立体图可以生动逼真地描述制图对象在平面和空间上分布的形态特征和构造关系。
            * 分析立体图,可以了解地理模型表面的平缓起伏,可以分析各个断面的状况。
            * 可以了解研究区域的轮廓形态、变化规律以及内部结构。
            * 制作透视立体图的基本流程
                * 理论基础是透视原理
                * 视点、视角不同,可以绘制方位、距离各异,形态各不相同的透视图,并制作动画
                * 四个参数:
                    * 观察方位:观察者对地面的方向;
                    * 观察角度:观察者所在高度与地平面的夹角;
                    * 观察距离:观察者与地表的距离;
                    * 竖向比例尺:垂直比例尺与水平比例尺的比率。
        * ![][sa-contour-shade]
        * ![][sa-contour-shade2]

2. 三维可视化
    * 三维可视化是三维 GIS 的基本功能。在进行三维分析时,数据的输入和对象的选择都涉及到三维对象的可视化。
    * 三维可视化是运用计算机图形学和图像处理技术,将三维空间分布的复杂对象 ( 如地形、模型等 ) 或过程转换为图形或图像在屏幕上显示并进行交互处理的技术和方法。
    * 观察坐标系中的三维裁剪:
        * 人眼的观察范围是有一定角度和距离范围。在计算机实现三维可视化的时候,也有一定的观察范围,可用视景体 (Frustum) 来表示这个范围。
        * 视景体 (Frustum) :由远、近、左、右、上、下 6 个平面确定。包括:
            * 平行投影视景体
            * 透视投影视景体
        * 在三维图形显示过程中,将位于视景体范围外的物体裁剪掉而不显示。
            * 通过判断对象与视景体中的 6 个裁剪面的关系可以确定对象是否位于视景体内部。
            * 用户还可以根据需要增加一个附加裁剪面,去掉与场景无关的目标。
        * ![][sa-3d-display]
        * ![][sa-projection]
    * 视口变换
        * Dim
            * 视口变换是指经过坐标变换、几何裁剪、投影变换后的物体显示到视口区域。
            * 视口变换类似指定区域的缩放操作;
            * 视口的长宽比例应与视景体一致,否则会使视口内的投影图像发生变形。
            * 当视角增大,投影平面的面积增大,视口面积与投影平面面积的比值变小,但由于物体的投影尺寸不变,所以实际显示的物体变小。反之,视角变小时,显示物体变大。
        * cat
            * 视图(视点)变换:把相机放在三角架上,并对准场景;
            * 模型变换:对场景进行安排,使物体在照片中位于你所希望的位置;
            * 投影变换:选择相机的镜头,调整放大倍数; 
            * 视口变换:确定照片的大小。
    * 常用的开发包: OpenGL、DirectX、QD3D、VTK、Java3D等, 用户可以利用这些开发包提供的接口实现三维显示中的各种功能。

3. 三维空间查询
    * 三维数据的空间查询是三维 GIS 的基本功能之一, 是其它三维空间分析的基础。
    * 三维空间查询的方式包括: 
        * 基于属性数据的三维查询 ;
        * 基于图形数据的三维查询 ;
        * 图形属性的混合三维查询 ;
        * 模糊三维查询等。
    * 三维坐标查询
        * 在获取三维坐标的过程中,由于屏幕上的三维模型的像点与三维模型的大地坐标不是一一对应的,必须把鼠标捕捉到的二维屏幕坐标转换为三维的大地坐标,这实际上是透视投影的逆过程。(屏幕二维点到三维坐标点的转换)
        * 高程查询: 对 TIN 数据,用内插的方法求出任意一点的高程。 
            * 一般使用线性内插。 
            * 内插过程包括格网点定位和高程内插两个过程。
                * 格网点定位
                * 高程内插

4. 三维空间特征量算
    * 表面积计算
        * 分块曲面拟合:
        * 全局拟合的曲面:
            * 三角形格网表面积
                * 海伦公式
                    * S = [ P( P − a)( P − b )( P − c )] 1 / 2
                    * P = ( a + b + c) / 2
            * 正方形格网表面积: 
                * 曲面拟合重积分法
                    * S = ∫∫ (1+f(x)^2 +f(x)^2)^(1/2) dxdy 
                    * 该式无法直接计算,常用的方法是近似计算。比较常用的方法是抛物线求积方法,亦称**辛卜生**方法。
                * 分解为三角形的方法
    * 体积计算
        * 基本思想: 以基底面积 ( 三角形或正方形 ) 乘以格网点曲面高度的均值,区域总体积是这些基本格网体积之和。
        * 基于三角形格网的体积计算方法
            * V = Sa( h1 + h2 + h3 ) / 3
            * ![][sa-volumn-tri]
        * 基于正方形格网的体积计算方法
            * V = SA( h1 + h2 + h3 + h4 ) / 4

5. 常用的三维数据空间分析

* 坡度和坡向计算
    * 坡度:某点在曲面上的法线方向与垂直方向的夹角,是地面特定点高度变化比率的度量。
    * 坡向:法线的正方向在平面上的投影与正北方向的夹角,即法方向水平投影向量的方位角。取值范围从零方向 ( 正北方向 ) 顺时针到 360 度。
    * 坡度和坡向计算
        * 基于规则格网 DEM 的坡度坡向计算
            * 设标准矢量为 (nx, ny, nz) ,则该格网单元的坡度 S 为: S = sqrt(nx+ny)/nz, 坡向 D 为: D = arctan(nx/ny) 
            * 在实际计算时,通常是用 3×3 的移动窗口来计算中心单元的坡度和坡向
            * 计算时考虑邻接单元的影响有不同方式,常用的方法:
                * Ritter 算法
                    * 只考虑直接与中心点单元相邻的 4 个单元,图中中心点 e  
                    * 坡度 Se = (e1−e3)2+(e4−e2)2/2d
                    * 坡向 De = arctan[(e4−e2)/(e1−e3)]+90°
                * Horn 算法
                    * 考虑与中心单元相邻的 8 个相邻单元,直接邻接单元 (e2, e4, e5, e7) 的权值为 2 ,其它 4 个单元 (e1, e3, e6, e8) 的权值为 1
                    * ![][sa-horn-s]
                    * ![][sa-horn-d]
        * 基于不规则三角网 (TIN) 的坡度坡向计算
            * ![][sa-irregular-sd]
        * 基于等高线的坡度坡向计算
            * 等高线计长法
                * 等高线计长法求出的是一个区域内坡度的均值,前提是量测区域内的等高距相等。
                * 对于测区较大或等高距不等的情况计算出坡度有较大误差。
            * 统计学计算方法
                * 是等高线计长方法的变通方法,用于测区较大或等高距不等的情况。其基本逻辑:地形坡度越大等高线越密、坡度越小等高线越稀。
                * 优点：可操作性强，不受数据量的限制，能处理海量数据。
* 剖面分析
    * 以数字地形模型( DEM )为基础构造某一个方向的剖面,以线代面,概括研究区域的地势、地质和水文特征;
    * 可在地形剖面上叠加表示其它地理变量,可以作为提供土地侵蚀速度研究、农业生产布局的立体背景分析、土地利用规划, 以及工程决策
    * 基础: 地形剖面线 (地形剖面线根据所选剖面与数字地形图上地形表面的交点反应地形的起伏情况。)
    * 生成方法: 
        * 基于规则格网 (Grid) 的方法
            * 确定剖面线的起止点。由坐标确定,或用鼠标在三维场景中选择决定;
            * 计算剖面线与经过网格的所有交点,内插出各交点的坐标和高程,将交点按离起始点的距离排序;
            * 顺序连接相邻交点,得到剖面线;
            * 选择一定的垂直比例尺和水平比例尺,以离起始点的距离为横坐标,以各点的高程值为纵坐标绘制剖面图。
        * 基于不规则三角网 (TIN) 的方法
            * 用剖面所在的直线与 TIN 中的三角面的交点得到剖面线。
            * 可先利用 TIN 中各三角形构建的拓扑关系快速找到与剖面线相交的三角面,再进行交点的计算,这样可以提高运算速度。
            * 最后,以距离起始点的距离为横坐标,以各点的高程值为纵坐标绘制剖面图。
* 谷脊特征分析
    * 是地形分析的重要内容, 在地学中的水文分析中有重要应用。如地表径流分析首先要找出该区域的谷脊点。
    * 谷: 地势中相对最低点的集合
    * 脊: 是地势相对最高点的集合
    * 基于栅格 DEM 数据判断谷点和脊点
        * ![][sa-low-high]
        * VR(i,j)= -1 => 谷点, VR(i,j)= +1 =>脊点; 该方法只能提供概略结果
        * 对谷脊特征作精确分析
            * 由曲面拟合方程建立地表单元的曲面方程;
            * 确定曲面上各个插值点的极小值和极大值;
            * 当插值点在两个相互垂直的方向上分别为极大值或极小值时,确定出谷点或脊点。
* 水文分析
    * 数据基础: 无洼地的 DEM
    * 关键步骤: 流向分析
    * 水文分析使用DEM数据派生其它水文特征: 提取河流网络、自动划分流域。这些是描述某一地区水文特征的重要因素
    * 无洼地 DEM 的生成
        * ![][sa-filled-sink]
        * DEM 数据中存在误差;
        * 存在一些真实的低洼地形,如喀斯特地貌
        * 在进行水流方向计算时,由于凹陷区域的存在,往往得到不合理的甚至错误的水流方向
    * 流向分析
        * 根据中心格网与邻域格网的最大距离权落差确定。
        * 距离权落差:中心栅格与邻域栅格的高程差除以两栅格间的距离。
        * 栅格间的距离与方向有关
            * ![][sa-grid-encoding]
            * 方向数为 1,4,16,64 ,距离为栅格单元边长的2 倍
            * 方向数为 2,8,32,128 ,距离为栅格单元的边长
    * 汇流累积矩阵的计算
        * 汇流累积数值矩阵:用矩阵形式表示区域地形每点的流水累积量。
        * 基本思想:
            * 以规则格网表示的数字地面高程模型的每点都有一个单位水量
            * 按照自然水流从高处往低处流的自然规律
            * 根据区域地形的水流方向数据计算每点处所流过的水量数值
            * 计算得到该区域的汇流累积量。
    * 水流长度:地面上一点沿水流方向到其流向起点 ( 或终点 ) 间的最大地面距离在水平面上的投影长度。
        * 水流长度的计算: 地面上一点沿水流方向到其流向起点 ( 或终点 ) 间的最大地面距离在水平面上的投影长度。
        * ![][sa-river-length]
    * 河网提取 (方法):
        * 主要采用地表径流漫流模型
        * 河网的生成基于流水累积量。
        * 设定阈值,思想是根据所设定的阈值对整个区域进行判断,
        * 其中汇流量大于阈值栅格,就是潜在的水流路径。
    * 河流分级
        * Strahler 河流分级方法
        * Shreve 河流分级方法
        * ![][sa-river-classify] 
    * 流域的分割
        * 流域又称集水区域,指流经其中的水流和 / 或其它物质从一个公共的出水口排出从而形成了一个集中的排水区域。
        * 流域显示每个流域汇水区域的大小。
        * 出水口 ( 或出水点 ) 是流域内水流的出口,是整个流域的最低处。
        * 流域间的分界线是分水岭。
        * 分水岭包围的区域称为一条河流或水系的流域,
        * 流域分水线所包围的区域面积就是流域面积。
* 水淹分析: 
    * 洪水淹没方式分为:
        * 漫堤式淹没: 分析在特定水位条件下,洪水会导致多大的淹没范围和多高的水深分布。
        * 决堤式淹没: 分析某一洪量条件下,洪水可能造成多大的淹没范围和水深分布。
    * 水淹分析是基于地形数据实现的。
        * TIN 数据: 由于其存储和分析的复杂性,不利于水淹分析。
        * GRID 数据: 水淹分析的主要数据源。
    * 给定洪水水位的淹没分析:
        * 首先确定洪水水源入口 ;
        * 再根据给定的洪水水位,从水源处开始进行格网连通性分析,所有能够与入口处连通的格网单元就是洪水淹没的范围。
        * 计算淹没范围内格网的水深 W,得到水深分布情况: W = H - E, (H: 洪水水位; E: 格网单元高程值)
    * 水流方向:由高向低沿着坡度最陡的方向流动,可以根据该点的 8 个相邻格网的高程来判断。
        * 具体算法:
        * 首先从水平、垂直四个方向的格网( 灰色部分 ) 高程中找出最大高程点 hmax1 和最小高程点 hmin1 ;
        * 从对角线的四个方向 ( 白色部分 ) 找出最大高程点 hmax2 和最小高程点 hmin2 ;
        * 对 hmax1 和 hmax2 进行比较: max((hmax1-h)/d, (hmax2-h)/(sqrt(2)*d)): d : DEM 格网间距 ; h : DEM 中当前点的高程。
        * 选出的点即当前点的上游点 ( 入水点 ) 。
* 径流分析:
    * 能够形成地表径流的地貌形态:河流及洪水形成的山谷沟渠。
    * 河流和山谷都属于谷地地貌,可以通过山谷线来判断,山谷线的生成与谷点分布相关。
    * 进行径流分析前要先找出该区域的谷脊点。
    * 通过谷脊分析得到谷点和脊点后,可根据山谷线的特征获取山谷线,从而得到地表径流路径。
* 叠置分析
* 阴影分析
* 可视性分析
* 缓冲区分析

6. ArcGIS 的三维数据空间分析工

[sa-digital-terrian-model]: src/sa/sa-digital-terrian-model.png
[sa-dem-present]: src/sa/sa-dem-present.png
[sa-grid-tin-contour]: src/sa/sa-grid-tin-contour.png
[sa-contour-shade]: src/sa/sa-contour-shade.png
[sa-contour-shade2]: src/sa/sa-contour-shade2.png
[sa-3d-display]: src/sa/sa-3d-display.png
[sa-projection]: src/sa/sa-projection.png
[sa-volumn-tri]: src/sa/sa-volumn-tri.png
[sa-horn-s]: src/sa/sa-horn-s.png
[sa-horn-d]: src/sa/sa-horn-d.png
[sa-irregular-sd]: src/sa/sa-irregular-sd.png
[sa-filled-sink]: src/sa/sa-filled-sink.png
[sa-grid-encoding]: src/sa/sa-grid-encoding.png
[sa-river-length]: src/sa/sa-river-length.png
[sa-river-classify]: src/sa/sa-river-classify.png